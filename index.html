<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Resilience Dashboard</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container container--narrow">
    <div class="header" style="background: transparent; box-shadow: none; text-align: center;">
      <h1 style="font-size: 32px; margin-bottom: 8px;">Resilience Dashboard</h1>
      <p>Faction tracking tools</p>
    </div>

    <div class="faction-overview" id="factionOverview">
      <div class="overview-loading">Loading faction data...</div>
    </div>

    <div class="tools-grid">
      <a href="xanax.html" class="tool-card">
        <h2>Xanax Tracker</h2>
        <p>Track weekly Xanax usage across faction members. See who's on track and who's falling behind.</p>
      </a>

      <a href="energy.html" class="tool-card">
        <h2>Energy Monitor <span class="new-badge">New</span></h2>
        <p>Monitor how much energy each faction member is using in the gym.</p>
      </a>

      <a href="war.html" class="tool-card">
        <h2>War Tracker</h2>
        <p>Track med outs for each war.</p>
      </a>
    </div>
  </div>

  <script>
    var API_KEY = 'POW66la7QjNjI97z';
    var API_URL = 'https://api.torn.com/v2/faction/basic';

    async function loadFactionData() {
      var container = document.getElementById('factionOverview');
      
      try {
        var response = await fetch(API_URL, {
          headers: {
            'Accept': 'application/json',
            'Authorization': 'ApiKey ' + API_KEY
          }
        });
        
        var data = await response.json();
        var faction = data.basic;
        
        container.innerHTML = 
          '<div class="overview-header">' +
            '<h2>' + faction.name + '</h2>' +
            '<span class="tag">' + faction.tag + '</span>' +
          '</div>' +
          '<div class="overview-stats">' +
            '<div class="stat-item">' +
              '<div class="stat-value highlight">' + faction.members + '<span class="members-fraction">/' + faction.capacity + '</span></div>' +
              '<div class="stat-label">Members</div>' +
            '</div>' +
            '<div class="stat-item">' +
              '<div class="stat-value">' + faction.respect.toLocaleString() + '</div>' +
              '<div class="stat-label">Respect</div>' +
            '</div>' +
            '<div class="stat-item">' +
              '<div class="stat-value">' + faction.rank.name + '</div>' +
              '<div class="stat-label">Div ' + faction.rank.division + '</div>' +
            '</div>' +
            '<div class="stat-item">' +
              '<div class="stat-value">' + faction.rank.wins + '</div>' +
              '<div class="stat-label">Ranked Wins</div>' +
            '</div>' +
            '<div class="stat-item">' +
              '<div class="stat-value">' + faction.best_chain.toLocaleString() + '</div>' +
              '<div class="stat-label">Best Chain</div>' +
            '</div>' +
            '<div class="stat-item">' +
              '<div class="stat-value">' + faction.days_old.toLocaleString() + '</div>' +
              '<div class="stat-label">Days Old</div>' +
            '</div>' +
          '</div>';
      } catch (error) {
        container.innerHTML = '<div class="overview-loading">Failed to load faction data</div>';
      }
    }

    loadFactionData();
  </script>
  <script src="theme.js"></script>
</body>
</html>
